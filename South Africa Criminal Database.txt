South Africa Criminal Database - 30 SQL Questions (Questions Only)

1. Display all records from the CriminalCases table.
SELECT *	
	FROM [SA_Criminals].[dbo].[south_africa_criminal_details]

2. Count the total number of cases in the table.
SELECT COUNT (*) 
FROM  [SA_Criminals].[dbo].[south_africa_criminal_details]

3. Count the number of cases in each province.
SELECT COUNT(CaseNumber) AS CASES
,Province
FROM [SA_Criminals].[dbo].[south_africa_criminal_details]
GROUP BY PROVINCE 

4. Retrieve all cases where the crime type is Fraud.
 SELECT *	
	FROM [SA_Criminals].[dbo].[south_africa_criminal_details]
	WHERE CrimeType = 'Fraud'

5. Count the number of cases for each crime type.
 SELECT COUNT(CrimeType) as Number_Of_Cases_per_crime, CrimeType
	FROM [SA_Criminals].[dbo].[south_africa_criminal_details]
	Group By CrimeType

6. Display all cases classified as High or Critical risk.
SELECT *	
	FROM [SA_Criminals].[dbo].[south_africa_criminal_details]
	where Risklevel = 'High' 
	or Risklevel = 'Critical'

7. Calculate the average Financial Score of all suspects.

SELECT AVG(FINANCIALSCORE) 
FROM [SA_Criminals].[dbo].[south_africa_criminal_details]

8. Find the highest Estimated Fraud Amount recorded.

SELECT MAX(Estimatedfraudamount_ZAR) AS Highest_Record
 FROM [SA_Criminals].[dbo].[south_africa_criminal_details]

 SELECT *
 FROM [SA_Criminals].[dbo].[south_africa_criminal_details]
 
9. Retrieve the top 10 cases with the highest Estimated Fraud Amount.
SELECT TOP 10 *
 FROM [SA_Criminals].[dbo].[south_africa_criminal_details]
 ORDER BY Estimatedfraudamount_ZAR DESC

10. Display all cases where the suspect was arrested.

SELECT *
FROM [SA_Criminals].[dbo].[south_africa_criminal_details]
WHERE ARRESTED = '1'

11. Count how many suspects were arrested versus not arrested.

SELECT ARRESTED,
COUNT(*) AS NUMBER_OF_SUSPECTS
FROM [SA_Criminals].[dbo].[south_africa_criminal_details]
GROUP BY Arrested

12. Count the number of cases associated with each bank.
SELECT COUNT(Bankinvolved) as Number_Of_banks,Bankinvolved
from [SA_Criminals].[dbo].[south_africa_criminal_details]
group by Bankinvolved

select * FROM [SA_Criminals].[dbo].[south_africa_criminal_details]
13. Calculate the total Estimated Fraud Amount per province.

SELECT COUNT(ESTIMATEDFRAUDAMOUNT_ZAR) AS EST_FRAUD, PROVINCE
FROM [SA_Criminals].[dbo].[south_africa_criminal_details]
GROUP BY Province

14. Retrieve all suspects older than 50 years.
SELECT *
 FROM [SA_Criminals].[dbo].[south_africa_criminal_details]
  WHERE AGE > 50

15. Calculate the average age of suspects per province.

SELECT AVG(age) as Average_Age,
Province
FROM [SA_Criminals].[dbo].[south_africa_criminal_details]
GROUP BY PROVINCE
16. Display all cases recorded from 2020 onwards.
 select *
 from [SA_Criminals].[dbo].[south_africa_criminal_details]
 where crimedate >= '2020-01-01'

17. Count how many cases resulted in a Convicted status.

SELECT COUNT(*) AS Convicted_cases
FROM [SA_Criminals].[dbo].[south_africa_criminal_details]
where Casestatus = 'Convicted'

18. Retrieve all suspects with more than three previous offenses.

SELECT *
FROM [SA_Criminals].[dbo].[south_africa_criminal_details]
WHERE PREVIOUSOFFENSES > 3

19. Show the distribution of cases by Risk Level.
SELECT Risklevel, count(*) as numberofcases
from [SA_Criminals].[dbo].[south_africa_criminal_details]
group by risklevel


20. Calculate the total Estimated Fraud Amount across all cases.
SELECT SUM(CAST(EstimatedFraudAmount_ZAR AS BIGINT)) AS est_across_all
FROM [SA_Criminals].[dbo].[south_africa_criminal_details];

select * from [SA_Criminals].[dbo].[south_africa_criminal_details]
21. Identify the province with the highest number of cases.
SELECT TOP 1 PROVINCE,
COUNT(*) AS Numberofcases
FROM [SA_Criminals].[dbo].[south_africa_criminal_details]
GROUP BY PROVINCE
ORDER BY COUNT(*) DESC

22. Retrieve the youngest suspect in the dataset.

SELECT TOP 1 *
FROM [SA_Criminals].[dbo].[south_africa_criminal_details]
ORDER BY AGE ASC

23. Retrieve the oldest suspect in the dataset.
SELECT TOP 1 *
FROM [SA_Criminals].[dbo].[south_africa_criminal_details]
ORDER BY AGE DESC


24. Count the number of cases handled by each investigating officer.

SELECT InvestigatingOfficer, COUNT(*) AS NumberOfCases
FROM [SA_Criminals].[dbo].[south_africa_criminal_details]
GROUP BY InvestigatingOfficer
ORDER BY COUNT(*) DESC;

25. Calculate the average Estimated Fraud Amount per crime type.

SELECT CrimeType, AVG(EstimatedFraudAmount_ZAR) AS AvgFraud_ZAR
FROM [SA_Criminals].[dbo].[south_africa_criminal_details]
GROUP BY CrimeType
ORDER BY AVG(EstimatedFraudAmount_ZAR) DESC;

26. Display all cases occurring in Gauteng province.
SELECT *
FROM [SA_Criminals].[dbo].[south_africa_criminal_details]
WHERE Province = 'Gauteng';

27. Retrieve all Fraud cases classified as High risk.
SELECT *
FROM [SA_Criminals].[dbo].[south_africa_criminal_details]
WHERE CrimeType = 'Fraud'
  AND RiskLevel = 'High';
28. Count the number of cases per year based on CrimeDate.
SELECT YEAR(CrimeDate) AS CrimeYear,
       COUNT(*) AS NumberOfCases
FROM [SA_Criminals].[dbo].[south_africa_criminal_details]
GROUP BY YEAR(CrimeDate)
ORDER BY CrimeYear;

29. Display all suspects with a Financial Score below 500.
SELECT *
FROM [SA_Criminals].[dbo].[south_africa_criminal_details]
WHERE FinancialScore < 500;